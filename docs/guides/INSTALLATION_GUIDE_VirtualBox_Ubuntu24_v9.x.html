<h1>Non-Profit Fund Accounting System v9.x</h1>
<h2>Installation Guide – Ubuntu 24.04 LTS Guest in VirtualBox (Windows / macOS Host)</h2>
<p><em>Document version 9.x – July 2025</em></p>
<hr>
<h2>1 Overview</h2>
<p>This guide walks through a <strong>clean installation</strong> of the Non-Profit Fund Accounting System v9.x inside an Ubuntu 24.04 LTS virtual machine (VM) running under Oracle VM VirtualBox.<br>The procedure matches the <strong>working macOS reference environment</strong> (Node.js 18, PostgreSQL 16, Express 5) and leverages the project’s cross-platform automation scripts.</p>
<hr>
<h2>2 Prerequisites &amp; Host Requirements</h2>
<table>
<thead>
<tr>
<th>Component</th>
<th>Minimum</th>
<th>Recommended</th>
</tr>
</thead>
<tbody><tr>
<td>Host OS</td>
<td>Windows 10/11 or macOS 13+</td>
<td>—</td>
</tr>
<tr>
<td>CPU</td>
<td>4 physical cores with VT-x / AMD-V</td>
<td>6+ cores</td>
</tr>
<tr>
<td>RAM</td>
<td>8 GB</td>
<td>16 GB (allocate ≥ 6 GB to guest)</td>
</tr>
<tr>
<td>Disk</td>
<td>40 GB free</td>
<td>80 GB on SSD / NVMe</td>
</tr>
<tr>
<td>Software</td>
<td>Oracle VirtualBox ≥ 7.0, Ubuntu 24.04 Desktop ISO</td>
<td>—</td>
</tr>
</tbody></table>
<blockquote>
<p>Enable hardware virtualization in BIOS/UEFI before installing VirtualBox.</p>
</blockquote>
<hr>
<h2>3 Create the VirtualBox VM</h2>
<ol>
<li><p><strong>Download software</strong><br>• VirtualBox: <a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a><br>• Ubuntu 24.04 ISO: <a href="https://ubuntu.com/download/desktop">https://ubuntu.com/download/desktop</a></p>
</li>
<li><p><strong>New VM</strong><br>• Name <code>Ubuntu24-FundAcct-v9x</code><br>• Type <em>Linux</em> → Version <em>Ubuntu (64-bit)</em><br>• Memory <strong>6144 MB</strong> • Processors <strong>4 vCPU</strong><br>• Disk <strong>VDI</strong>, dynamically allocated, <strong>60 GB</strong></p>
</li>
<li><p><strong>Tweaks</strong><br>Display → Graphics Controller <strong>VBoxSVGA</strong>, enable <strong>3-D Acceleration</strong><br>Network Adapter 1 → <strong>Bridged</strong> (preferred) or <strong>NAT</strong><br>Storage → attach the Ubuntu ISO.</p>
</li>
<li><p><strong>Install Ubuntu</strong><br>Normal installation, enable third-party codecs (optional).<br>Create user <strong>fundadmin</strong> (will have <code>sudo</code>).<br>After first boot:  </p>
<pre><code class="language-bash">sudo apt update &amp;&amp; sudo apt -y upgrade
sudo reboot
</code></pre>
</li>
</ol>
<hr>
<h2>4 Install Runtime Dependencies inside the VM</h2>
<pre><code class="language-bash"># Essential tools
sudo apt install -y git build-essential curl

# Node.js 18 LTS (via NodeSource)
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs   # node 18.x, npm 10.x+

# PostgreSQL 16 (official PGDG repository)
echo &quot;deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main&quot; | \
  sudo tee /etc/apt/sources.list.d/pgdg.list
curl -fsSL https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
sudo apt update
sudo apt install -y postgresql-16

# Verify toolchain
node -v   # v18.x
npm  -v   # 10.x+
psql -V   # 16.x
</code></pre>
<hr>
<h2>5 Application Installation</h2>
<h3>5.1 Clone the Repository</h3>
<pre><code class="language-bash">sudo mkdir -p /opt &amp;&amp; cd /opt
sudo git clone https://github.com/tpfbill/nonprofit-fund-accounting-v9.x.git
sudo chown -R $USER:$USER nonprofit-fund-accounting-v9.x
cd nonprofit-fund-accounting-v9.x
</code></pre>
<h3>5.2 Create <code>.env</code></h3>
<pre><code class="language-bash">cat &gt; .env &lt;&lt;&#39;EOF&#39;
# Database
PGHOST=localhost
PGPORT=5432
PGDATABASE=fund_accounting_db
PGUSER=npfadmin
PGPASSWORD=npfa123

# Server
PORT=3000
EOF
chmod 600 .env
</code></pre>
<h3>5.3 Install Node Dependencies</h3>
<pre><code class="language-bash">npm ci
</code></pre>
<p>Dependencies (excerpt from <em>package.json</em>):</p>
<ul>
<li>express <strong>5.1.0</strong></li>
<li>pg 8.16</li>
<li>http-server 14.1</li>
<li>concurrently 8.2</li>
</ul>
<hr>
<h2>6 Database Setup</h2>
<h3>Option A (one-line, interactive)</h3>
<p>Run the hardened Ubuntu helper script (idempotent):</p>
<pre><code class="language-bash">scripts/setup-ubuntu-database.sh
</code></pre>
<p>The script:</p>
<ol>
<li>Ensures PostgreSQL service is running.</li>
<li>Creates role <strong>npfadmin / npfa123</strong>.</li>
<li>Creates database <strong>fund_accounting_db</strong> owned by <code>npfadmin</code>.</li>
<li>Executes <code>database/db-init.sql</code> (core schema) and
<code>database/nacha-vendor-payments-schema.sql</code> (ACH vendor payments).</li>
<li>Loads demo data via <code>database/load-principle-foundation-data.js</code>.</li>
<li>Writes/updates the <code>.env</code> file and verifies connectivity.</li>
</ol>
<h3>Option B (manual)</h3>
<pre><code class="language-bash"># 1. Create role &amp; DB (cross-platform SQL)
sudo -u postgres psql -f database/setup-database-cross-platform.sql

# 2. Core schema
sudo -u postgres psql -d fund_accounting_db -f database/db-init.sql

# 3. NACHA vendor-payment extension
sudo -u postgres psql -d fund_accounting_db -f database/nacha-vendor-payments-schema.sql

# 4. (Optional) Demo data
node database/load-principle-foundation-data.js
</code></pre>
<hr>
<h2>7 Run the Application</h2>
<p>Open <strong>two terminals</strong> or use <code>npm run dev</code>.</p>
<pre><code class="language-bash"># Terminal 1 – REST API (port 3000)
node server.js
</code></pre>
<pre><code class="language-bash"># Terminal 2 – Static front-end (port 8080)
npx http-server . -p 8080 --no-cache
</code></pre>
<p>Helper scripts:</p>
<pre><code class="language-bash">npm run client   # only front-end
npm run dev      # backend + frontend concurrently
</code></pre>
<p>Browse to <strong><a href="http://localhost:8080/index.html">http://localhost:8080/index.html</a></strong>.</p>
<hr>
<h2>8 Testing &amp; Verification Checklist</h2>
<table>
<thead>
<tr>
<th>Test</th>
<th>Steps</th>
<th>Expected</th>
</tr>
</thead>
<tbody><tr>
<td>API health</td>
<td><code>curl http://localhost:3000/api/health</code></td>
<td><code>{&quot;status&quot;:&quot;ok&quot;}</code></td>
</tr>
<tr>
<td>Dashboard</td>
<td>Open <code>/index.html</code></td>
<td>Summary cards and charts render</td>
</tr>
<tr>
<td>Vendor Directory</td>
<td><em>Vendor Payments ➜ Vendors</em></td>
<td>List shows, <strong>Add Vendor</strong> modal works</td>
</tr>
<tr>
<td>Payment Batch</td>
<td><em>Vendor Payments ➜ Batches ➜ New</em></td>
<td>Entity &amp; Fund dropdowns populate</td>
</tr>
<tr>
<td>NACHA File</td>
<td>Create batch ➜ Approve ➜ <strong>Generate NACHA</strong></td>
<td><code>.ACH</code> file appears &amp; downloads</td>
</tr>
<tr>
<td>DB inspection</td>
<td><code>psql -d fund_accounting_db -c &#39;\dt&#39;</code></td>
<td>16 tables incl. <code>payment_batches</code>, <code>nacha_files</code></td>
</tr>
</tbody></table>
<hr>
<h2>9 Troubleshooting</h2>
<table>
<thead>
<tr>
<th>Symptom</th>
<th>Resolution</th>
</tr>
</thead>
<tbody><tr>
<td>“DB offline” badge</td>
<td><code>sudo systemctl restart postgresql</code> and verify <code>.env</code></td>
</tr>
<tr>
<td>Port 3000 in use</td>
<td><code>sudo lsof -i:3000</code> → <code>kill &lt;PID&gt;</code></td>
</tr>
<tr>
<td>Empty dropdowns (batch modal)</td>
<td>Re-run step 6.3 (NACHA schema) &amp; restart API</td>
</tr>
<tr>
<td>CSS not updating</td>
<td>Hard-refresh (Ctrl-F5) or <code>--no-cache</code> flag</td>
</tr>
<tr>
<td>Script permission denied</td>
<td><code>chmod +x scripts/setup-ubuntu-database.sh</code></td>
</tr>
</tbody></table>
<hr>
<h2>10 Performance Tips</h2>
<ol>
<li>Allocate extra vCPU/RAM to the VM.  </li>
<li>Enable <strong>Nested Paging</strong> &amp; <strong>KVM Paravirtualization</strong> in VirtualBox.  </li>
<li>Store the VDI on an SSD/NVMe host drive.  </li>
<li>Tune PostgreSQL (<code>shared_buffers = 512MB</code>, <code>work_mem = 16MB</code>).  </li>
<li>Use <strong>Bridged</strong> networking for faster host↔guest transfers.</li>
</ol>
<hr>
<h2>11 Security Considerations</h2>
<ul>
<li>Change default passwords (<code>npfa123</code>) before production.  </li>
<li>Keep <code>.env</code> file <strong>chmod 600</strong> and outside version control.  </li>
<li>Enable UFW:  <pre><code class="language-bash">sudo ufw allow 8080/tcp
sudo ufw allow 3000/tcp
sudo ufw enable
</code></pre>
</li>
<li>Regularly apply <code>apt upgrade</code> and PostgreSQL minor updates.  </li>
<li>Snapshot the VM after successful installation.</li>
</ul>
<hr>
<h2>12 Appendix A – Useful Commands</h2>
<pre><code class="language-bash"># Stop both services
pkill -f http-server
pkill -f node

# Backup the database
sudo -u postgres pg_dump -Fc fund_accounting_db &gt; fundacct_$(date +%F).dump

# Restore
sudo -u postgres pg_restore -d fund_accounting_db -c fundacct_2025-07-22.dump
</code></pre>
<hr>
<p><strong>Enjoy your fully-functional Non-Profit Fund Accounting System v9.x on Ubuntu 24.04!</strong></p>
<p>For details on API endpoints and data model, see the in-app <strong>Documentation</strong> tab or <code>README.md</code>.</p>
